<Page x:Class="InventoryPC.Views.DetailsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:vm="clr-namespace:InventoryPC.ViewModels"
      xmlns:local="clr-namespace:InventoryPC.Converters"
      mc:Ignorable="d" 
      d:DesignHeight="600" d:DesignWidth="1000">
    <Page.DataContext>
        <vm:DetailsViewModel/>
    </Page.DataContext>
    <Grid Background="Transparent">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <StackPanel Orientation="Horizontal" Margin="10">
            <Button Content="Назад" Command="{Binding NavigateBackCommand}" Width="100" Margin="5"
                    Style="{StaticResource RoundedButtonStyle}"/>
            <Button Content="Сохранить" Command="{Binding SaveCommand}" Width="100" Margin="5"
                    Style="{StaticResource RoundedButtonStyle}"/>
        </StackPanel>
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <StackPanel Grid.Column="0" Margin="10">
                    <TextBlock Text="Имя ПК:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.Name, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>
                    <TextBlock Text="Пользователь:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.User, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>
                    <TextBlock Text="Филиал:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBox Text="{Binding Computer.Branch, UpdateSourceTrigger=PropertyChanged}" Width="200" Margin="0,5"/>
                    <TextBlock Text="Кабинет:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBox Text="{Binding Computer.Office, UpdateSourceTrigger=PropertyChanged}" Width="200" Margin="0,5"/>
                    <TextBlock Text="Инвентарный номер:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBox Text="{Binding Computer.InventoryNumber, UpdateSourceTrigger=PropertyChanged}" Width="200" Margin="0,5"/>
                    <TextBlock Text="Версия Windows:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.WindowsVersion, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>

                    <!-- Новый блок для статуса активации -->
                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <TextBlock Text="Статус активации:" Foreground="White" FontSize="14"/>
                        <Ellipse Width="10" Height="10" Margin="5,0" VerticalAlignment="Center">
                            <Ellipse.Fill>
                                <Binding Path="Computer.ActivationStatus">
                                    <Binding.Converter>
                                        <local:StatusToColorConverter/>
                                    </Binding.Converter>
                                </Binding>
                            </Ellipse.Fill>
                        </Ellipse>
                    </StackPanel>
                    <TextBlock Text="{Binding Computer.ActivationStatus, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>

                    <TextBlock Text="Срок лицензии:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.LicenseExpiry, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>
                    <TextBlock Text="IP-адрес:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.IPAddress, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>
                    <TextBlock Text="MAC-адрес:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.MACAddress, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>
                    <TextBlock Text="SSID:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.SSID, FallbackValue=Нет}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>
                    <TextBlock Text="Принтеры:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.Printers, FallbackValue=Нет}" Foreground="#CCCCCC" FontSize="12" Margin="0,5" TextWrapping="Wrap"/>
                </StackPanel>
                <StackPanel Grid.Column="1" Margin="10">
                    <TextBlock Text="Процессор:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.Processor, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>
                    <TextBlock Text="Материнская плата:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.Motherboard, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>
                    <TextBlock Text="Версия BIOS:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.BIOSVersion, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>
                    <TextBlock Text="Видеокарта:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.VideoCard, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>
                    <TextBlock Text="Память видеокарты:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.VideoCardMemory, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>
                    <TextBlock Text="Драйвер видеокарты:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.VideoCardDriver, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>
                    <TextBlock Text="Диски:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.Disks, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5" TextWrapping="Wrap"/>
                    <TextBlock Text="Мониторы:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.Monitors, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5" TextWrapping="Wrap"/>
                    <TextBlock Text="Мышь:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.Mouse, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>
                    <TextBlock Text="Клавиатура:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.Keyboard, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>

                    <!-- Новый блок для статуса Office -->
                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <TextBlock Text="Статус Office:" Foreground="White" FontSize="14"/>
                        <Ellipse Width="10" Height="10" Margin="5,0" VerticalAlignment="Center">
                            <Ellipse.Fill>
                                <Binding Path="Computer.OfficeStatus">
                                    <Binding.Converter>
                                        <local:StatusToColorConverter/>
                                    </Binding.Converter>
                                </Binding>
                            </Ellipse.Fill>
                        </Ellipse>
                    </StackPanel>
                    <TextBlock Text="{Binding Computer.OfficeStatus, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>

                    <TextBlock Text="Лицензия Office:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.OfficeLicenseName, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5" TextWrapping="Wrap"/>
                    <TextBlock Text="Антивирус:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.AntivirusName, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>
                    <TextBlock Text="Версия антивируса:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.AntivirusVersion, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>

                    <!-- Новый блок для срока лицензии антивируса -->
                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <TextBlock Text="Срок лицензии антивируса:" Foreground="White" FontSize="14"/>
                        <Ellipse Width="10" Height="10" Margin="5,0" VerticalAlignment="Center">
                            <Ellipse.Fill>
                                <Binding Path="Computer.AntivirusLicenseExpiry">
                                    <Binding.Converter>
                                        <local:StatusToColorConverter/>
                                    </Binding.Converter>
                                </Binding>
                            </Ellipse.Fill>
                        </Ellipse>
                    </StackPanel>
                    <TextBlock Text="{Binding Computer.AntivirusLicenseExpiry, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>

                    <TextBlock Text="ОЗУ:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.Memory, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>
                    <TextBlock Text="Маска подсети:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.SubnetMask, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>
                    <TextBlock Text="Шлюз:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.Gateway, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>
                    <TextBlock Text="DNS-серверы:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.DNSServers, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5" TextWrapping="Wrap"/>
                    <TextBlock Text="Последняя проверка:" Foreground="White" FontSize="14" Margin="0,5"/>
                    <TextBlock Text="{Binding Computer.LastChecked, FallbackValue=Неизвестно}" Foreground="#CCCCCC" FontSize="12" Margin="0,5"/>
                </StackPanel>
            </Grid>
        </ScrollViewer>
    </Grid>
</Page>